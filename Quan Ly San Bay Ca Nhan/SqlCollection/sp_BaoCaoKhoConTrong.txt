USE [QL_SANBAY_CN]
GO
/****** Object:  StoredProcedure [dbo].[sp_BaoCaoKhoConTrong]    Script Date: 6/6/2023 11:16:35 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROC [dbo].[sp_BaoCaoKhoConTrong]
AS
BEGIN
SELECT K.IDKHO, VITRI, SUCCHUA,  CONTRONG = SUCCHUA - DANGCHUA 
FROM 
	KHO K
	INNER JOIN (SELECT IDKHO, COUNT(IDKHO) AS DANGCHUA FROM CT_KHO  GROUP BY IDKHO) CT 
	ON CT.IDKHO = K.IDKHO
WHERE SUCCHUA > DANGCHUA 
END